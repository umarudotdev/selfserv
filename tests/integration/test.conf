# Test configuration for webserv integration tests
# This configuration is designed to test all mandatory features

server 0.0.0.0 42069
  server_name example.local test.local
  error_page_root ./errors
  client_max_body_size 1048576  # 1 MiB
  header_timeout 5000
  body_timeout 10000
  idle_timeout 15000
  cgi_timeout 5000

  # Root route - serve static files
  route / ./www index=index.html methods=GET,POST,DELETE

  # Upload endpoint
  route /upload ./www uploadsEnabled=on upload_path=./uploads methods=POST

  # CGI endpoint for testing script execution
  route /cgi-bin ./www/cgi-bin cgi_ext=.py cgi_bin=/usr/bin/python3 methods=GET,POST

  # Directory listing test
  route /public ./www/public autoindex=on methods=GET

  # Redirect test
  route /old ./www redirect=/new-location methods=GET

  # Another route for testing different configurations
  route /api ./www methods=GET,POST,DELETE

# Second server for virtual host testing
server 0.0.0.0 42070
  server_name assets.local cdn.local
  error_page_root ./errors
  client_max_body_size 512000  # 500 KB limit for testing

  # Static assets only
  route / ./www/assets methods=GET
